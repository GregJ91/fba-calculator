<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple FBA Test</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .test { margin: 20px 0; padding: 15px; border-radius: 5px; }
        .pass { background-color: #e8f5e8; border: 1px solid #4caf50; }
        .fail { background-color: #ffeaea; border: 1px solid #f44336; }
        .result { font-weight: bold; margin-top: 10px; }
    </style>
    <script src="fba-calculator.js?v=20250812"></script>
</head>
<body>
    <h1>üß™ Simple FBA Calculator Test</h1>
    <div id="results"></div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            try {
                console.log('Creating calculator...');
                const calculator = new FBACalculator();
                console.log('Calculator created successfully!');
                
                const tests = [
                    {
                        name: "Small envelope (50g)",
                        dimensions: { height: 15, width: 10, depth: 0.8 },
                        weight: 0.05,
                        expected: "Small envelope"
                    },
                    {
                        name: "Small parcel (2.5kg)",
                        dimensions: { height: 30, width: 20, depth: 10 },
                        weight: 2.5,
                        expected: "Small parcel"
                    },
                    {
                        name: "Overweight small parcel ‚Üí Standard parcel",
                        dimensions: { height: 30, width: 20, depth: 10 },
                        weight: 4.5,
                        expected: "Standard parcel"
                    },
                    {
                        name: "Standard envelope (updated dimensions)",
                        dimensions: { height: 30, width: 20, depth: 2 },
                        weight: 0.3,
                        expected: "Standard envelope"
                    },
                    {
                        name: "Small oversize with surcharge",
                        dimensions: { height: 50, width: 40, depth: 30 },
                        weight: 2.5,
                        expected: "Small oversize"
                    }
                ];
                
                let html = '';
                let passed = 0;
                
                tests.forEach((test, index) => {
                    const { height, width, depth } = test.dimensions;
                    const sortedDims = [height, width, depth].sort((a, b) => b - a);
                    const dimensionalWeight = calculator.calculateDimensionalWeight(sortedDims[0], sortedDims[1], sortedDims[2]);
                    
                    const tier = calculator.determineSizeTier(test.dimensions, test.weight, dimensionalWeight);
                    const weightBracket = calculator.findWeightBracket(tier, test.weight);
                    const fee = calculator.calculateFee(tier, test.weight, 'UK', weightBracket);
                    
                    const success = tier.name === test.expected;
                    if (success) passed++;
                    
                    const cssClass = success ? 'pass' : 'fail';
                    const icon = success ? '‚úÖ' : '‚ùå';
                    
                    html += `
                        <div class="test ${cssClass}">
                            <h3>${icon} Test ${index + 1}: ${test.name}</h3>
                            <p><strong>Dimensions:</strong> ${test.dimensions.height} √ó ${test.dimensions.width} √ó ${test.dimensions.depth} cm</p>
                            <p><strong>Weight:</strong> ${test.weight} kg</p>
                            <p><strong>Dimensional Weight:</strong> ${dimensionalWeight.toFixed(3)} kg</p>
                            <p><strong>Expected:</strong> ${test.expected}</p>
                            <p><strong>Actual:</strong> ${tier.name}</p>
                            <p><strong>Weight Bracket:</strong> ${weightBracket.description}</p>
                            <p><strong>UK Fee:</strong> ${fee}</p>
                            <div class="result">${success ? 'PASS' : 'FAIL'}</div>
                        </div>
                    `;
                });
                
                html = `
                    <div style="text-align: center; margin: 20px 0; padding: 20px; background: #f0f0f0; border-radius: 8px;">
                        <h2>${passed === tests.length ? 'üéâ ALL TESTS PASSED!' : '‚ö†Ô∏è SOME TESTS FAILED'}</h2>
                        <p><strong>Pass Rate:</strong> ${passed}/${tests.length} (${((passed/tests.length)*100).toFixed(1)}%)</p>
                    </div>
                ` + html;
                
                document.getElementById('results').innerHTML = html;
                
            } catch (error) {
                document.getElementById('results').innerHTML = `
                    <div class="test fail">
                        <h3>‚ùå Error</h3>
                        <p><strong>Error:</strong> ${error.message}</p>
                        <p><strong>Stack:</strong> ${error.stack}</p>
                    </div>
                `;
                console.error('Test failed:', error);
            }
        });
    </script>
</body>
</html> 